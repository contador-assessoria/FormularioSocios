<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Formul√°rio de Cadastro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Tema Moderno Dark/Purple */
        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --secondary: #06b6d4;
            --accent: #f59e0b;
            --success: #10b981;
            --error: #ef4444;
            --dark: #1e1b4b;
            --dark-light: #312e81;
            --dark-card: #2d1b69;
            --text-light: #f8fafc;
            --text-muted: #cbd5e1;
            --border: #4c1d95;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, 
                #667eea 0%, 
                #764ba2 25%, 
                #f093fb 50%, 
                #f5576c 75%, 
                #4facfe 100%);
            min-height: 100vh;
            background-attachment: fixed;
        }

        /* Container principal com efeito glassmorphism */
        .main-container {
            background: rgba(30, 27, 75, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(139, 92, 246, 0.3);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
        }

        /* Header com gradiente */
        .header-gradient {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 2rem;
            border-radius: 1.5rem 1.5rem 0 0;
            position: relative;
            overflow: hidden;
        }

        .header-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }

        /* Cards das pessoas */
        .pessoa-card {
            background: rgba(45, 27, 105, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .pessoa-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .pessoa-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(139, 92, 246, 0.3);
            border-color: rgba(139, 92, 246, 0.5);
        }

        /* Inputs customizados */
        .input-custom {
            background: rgba(30, 27, 75, 0.8);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .input-custom:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
            background: rgba(30, 27, 75, 0.95);
        }

        .input-custom::placeholder {
            color: var(--text-muted);
        }

        /* Labels customizados */
        .label-custom {
            color: var(--text-light);
            font-weight: 500;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .label-custom.required::after {
            content: '*';
            color: var(--error);
            margin-left: 4px;
        }

        /* Bot√µes estilizados */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.6s ease;
        }

        .btn-primary:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(139, 92, 246, 0.4);
        }

        .btn-add {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 0.75rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            font-size: 0.875rem;
        }

        .btn-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-remove {
            background: linear-gradient(135deg, var(--error), #dc2626);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 0.75rem;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            font-size: 0.875rem;
        }

        .btn-remove:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
        }

        /* Mensagens */
        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
            padding: 1rem 1.5rem;
            border-radius: 1rem;
            color: white;
            max-width: 400px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .message.success {
            background: rgba(16, 185, 129, 0.9);
        }

        .message.error {
            background: rgba(239, 68, 68, 0.9);
        }

        /* Anima√ß√µes */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-slide-in {
            animation: slideIn 0.5s ease;
        }

        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100px); }
        }

        /* Responsividade */
        @media (max-width: 640px) {
            .header-gradient {
                padding: 1.5rem;
            }
            .pessoa-card {
                padding: 1rem;
            }
        }

        /* Scrollbar customizada */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* Contador de pessoas */
        .pessoa-counter {
            background: linear-gradient(135deg, var(--accent), #f97316);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-weight: 600;
            font-size: 0.875rem;
            position: absolute;
            top: 1rem;
            right: 1rem;
        }
    </style>
</head>
<body class="p-4 sm:p-6">
    <div id="message" class="message"></div>

    <div class="max-w-5xl mx-auto main-container rounded-2xl overflow-hidden animate-slide-in">
        <!-- Header -->
        <div class="header-gradient relative">
            <div class="relative z-10">
                <h1 class="text-3xl sm:text-4xl font-bold text-white text-center mb-2">
                    üìã Formul√°rio de Cadastro
                </h1>
                <p class="text-center text-slate-200 text-lg">
                    Gerencie os dados das pessoas e envie via WhatsApp
                </p>
                <div class="pessoa-counter" id="pessoaCounter">
                    üìä 1 Pessoa
                </div>
            </div>
        </div>

        <!-- Conte√∫do Principal -->
        <div class="p-6">
            <form id="formularioCadastro">
                
                <!-- Controles -->
                <div class="flex flex-wrap gap-3 mb-6 justify-center">
                    <button type="button" id="addPessoa" class="btn-add">
                        ‚ûï Adicionar Pessoa
                    </button>
                    <button type="button" id="removePessoa" class="btn-remove">
                        ‚ûñ Remover √öltima
                    </button>
                    <button type="button" id="modoTeste" class="btn-primary" style="background: linear-gradient(135deg, var(--accent), #f97316);">
                        üß™ Modo Teste
                    </button>
                </div>

                <!-- Container das Pessoas -->
                <div id="pessoasContainer" class="space-y-4">
                    <!-- Pessoas ser√£o inseridas aqui dinamicamente -->
                </div>

                <!-- Bot√£o de Envio -->
                <div class="mt-8 text-center">
                    <button type="button" id="enviarWhatsApp" class="btn-primary text-lg px-8 py-4">
                        üì± Enviar via WhatsApp
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // =================================================================
        // CONFIGURA√á√ïES
        // =================================================================
        const numeroWhatsApp = '55996636737';
        let pessoaCounter = 0;

        // =================================================================
        // FUN√á√ïES UTILIT√ÅRIAS
        // =================================================================
        function showMessage(text, type = 'error') {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = `message ${type}`;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 4000);
        }

        function formatarCPF(cpf) {
            cpf = cpf.replace(/\D/g, "");
            cpf = cpf.replace(/(\d{3})(\d)/, "$1.$2");
            cpf = cpf.replace(/(\d{3})(\d)/, "$1.$2");
            cpf = cpf.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
            return cpf;
        }

        function validarCPF(cpf) {
            cpf = cpf.replace(/[^\d]+/g, '');
            if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
            
            let soma = 0, resto;
            for (let i = 1; i <= 9; i++) soma += parseInt(cpf.substring(i - 1, i)) * (11 - i);
            resto = (soma * 10) % 11;
            if ((resto === 10) || (resto === 11)) resto = 0;
            if (resto !== parseInt(cpf.substring(9, 10))) return false;
            
            soma = 0;
            for (let i = 1; i <= 10; i++) soma += parseInt(cpf.substring(i - 1, i)) * (12 - i);
            resto = (soma * 10) % 11;
            if ((resto === 10) || (resto === 11)) resto = 0;
            return resto === parseInt(cpf.substring(10, 11));
        }

        function formatarCEP(cep) {
            cep = cep.replace(/\D/g, "");
            cep = cep.replace(/^(\d{5})(\d)/, "$1-$2");
            return cep;
        }

        function formatarCelular(celular) {
            celular = celular.replace(/\D/g, "");
            celular = celular.replace(/^(\d{2})(\d)/g, "($1) $2");
            celular = celular.replace(/(\d{5})(\d)/, "$1-$2");
            return celular;
        }

        // API ViaCEP
        async function buscarCEP(cep, pessoaId) {
            cep = cep.replace(/\D/g, '');
            if (cep.length !== 8) return;
            
            try {
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                const data = await response.json();
                
                if (!data.erro) {
                    document.getElementById(`logradouro_${pessoaId}`).value = data.logradouro;
                    document.getElementById(`bairro_${pessoaId}`).value = data.bairro;
                    document.getElementById(`municipio_${pessoaId}`).value = data.localidade;
                    document.getElementById(`uf_${pessoaId}`).value = data.uf;
                    
                    showMessage('CEP encontrado e campos preenchidos!', 'success');
                } else {
                    showMessage('CEP n√£o encontrado.');
                }
            } catch (error) {
                showMessage('Erro ao buscar CEP. Verifique sua conex√£o.');
            }
        }

        function atualizarContador() {
            const total = document.querySelectorAll('.pessoa-card').length;
            document.getElementById('pessoaCounter').textContent = `üìä ${total} Pessoa${total !== 1 ? 's' : ''}`;
        }

        // =================================================================
        // GERENCIAMENTO DE PESSOAS
        // =================================================================
        function adicionarPessoa(dados = {}) {
            pessoaCounter++;
            const container = document.getElementById('pessoasContainer');
            
            const pessoaDiv = document.createElement('div');
            pessoaDiv.className = 'pessoa-card animate-slide-in';
            pessoaDiv.id = `pessoa-${pessoaCounter}`;
            
            pessoaDiv.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold text-white">
                        üë§ Pessoa ${pessoaCounter}
                    </h3>
                    <button type="button" class="btn-remove" onclick="removerPessoa(${pessoaCounter})">
                        üóëÔ∏è Remover
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Dados Pessoais -->
                    <div class="lg:col-span-2">
                        <label class="label-custom required">Nome Completo:</label>
                        <input type="text" id="nome_${pessoaCounter}" name="pessoas[${pessoaCounter}][nome]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Digite o nome completo" required>
                    </div>
                    
                    <div>
                        <label class="label-custom required">CPF:</label>
                        <input type="text" id="cpf_${pessoaCounter}" name="pessoas[${pessoaCounter}][cpf]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3 cpf-input" 
                               placeholder="000.000.000-00" maxlength="14" required>
                    </div>
                    
                    <div>
                        <label class="label-custom">RG:</label>
                        <input type="text" id="rg_${pessoaCounter}" name="pessoas[${pessoaCounter}][rg]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Digite o RG">
                    </div>
                    
                    <div>
                        <label class="label-custom">√ìrg√£o Expedidor:</label>
                        <input type="text" id="orgao_${pessoaCounter}" name="pessoas[${pessoaCounter}][orgao]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Ex: SSP/RS">
                    </div>
                    
                    <div>
                        <label class="label-custom required">Data de Nascimento:</label>
                        <input type="date" id="nascimento_${pessoaCounter}" name="pessoas[${pessoaCounter}][nascimento]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" required>
                    </div>
                    
                    <div>
                        <label class="label-custom">Nacionalidade:</label>
                        <input type="text" id="nacionalidade_${pessoaCounter}" name="pessoas[${pessoaCounter}][nacionalidade]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               value="Brasileira" placeholder="Nacionalidade">
                    </div>
                    
                    <div>
                        <label class="label-custom">Naturalidade:</label>
                        <input type="text" id="naturalidade_${pessoaCounter}" name="pessoas[${pessoaCounter}][naturalidade]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Cidade/UF de nascimento">
                    </div>
                    
                    <div>
                        <label class="label-custom">Estado Civil:</label>
                        <select id="estado_civil_${pessoaCounter}" name="pessoas[${pessoaCounter}][estado_civil]" 
                                class="input-custom mt-1 block w-full rounded-lg p-3">
                            <option value="">Selecione</option>
                            <option value="Solteiro(a)">Solteiro(a)</option>
                            <option value="Casado(a)">Casado(a)</option>
                            <option value="Uni√£o Est√°vel">Uni√£o Est√°vel</option>
                            <option value="Divorciado(a)">Divorciado(a)</option>
                            <option value="Vi√∫vo(a)">Vi√∫vo(a)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="label-custom">Profiss√£o:</label>
                        <input type="text" id="profissao_${pessoaCounter}" name="pessoas[${pessoaCounter}][profissao]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Digite a profiss√£o">
                    </div>
                    
                    <!-- Contato -->
                    <div class="lg:col-span-3 mt-4">
                        <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                            üìû Contato
                        </h4>
                    </div>
                    
                    <div>
                        <label class="label-custom">Celular:</label>
                        <input type="text" id="celular_${pessoaCounter}" name="pessoas[${pessoaCounter}][celular]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3 celular-input" 
                               placeholder="(00) 00000-0000" maxlength="15">
                    </div>
                    
                    <div class="lg:col-span-2">
                        <label class="label-custom">E-mail:</label>
                        <input type="email" id="email_${pessoaCounter}" name="pessoas[${pessoaCounter}][email]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="exemplo@email.com">
                    </div>
                    
                    <!-- Endere√ßo -->
                    <div class="lg:col-span-3 mt-4">
                        <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                            üè† Endere√ßo Residencial
                        </h4>
                    </div>
                    
                    <div>
                        <label class="label-custom">CEP:</label>
                        <input type="text" id="cep_${pessoaCounter}" name="pessoas[${pessoaCounter}][cep]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3 cep-input" 
                               placeholder="00000-000" maxlength="9" data-pessoa="${pessoaCounter}">
                    </div>
                    
                    <div class="lg:col-span-2">
                        <label class="label-custom">Logradouro:</label>
                        <input type="text" id="logradouro_${pessoaCounter}" name="pessoas[${pessoaCounter}][logradouro]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Digite o logradouro">
                    </div>
                    
                    <div>
                        <label class="label-custom">N√∫mero:</label>
                        <input type="text" id="numero_${pessoaCounter}" name="pessoas[${pessoaCounter}][numero]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="N¬∫">
                    </div>
                    
                    <div>
                        <label class="label-custom">Complemento:</label>
                        <input type="text" id="complemento_${pessoaCounter}" name="pessoas[${pessoaCounter}][complemento]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Apto, sala, etc">
                    </div>
                    
                    <div>
                        <label class="label-custom">Bairro:</label>
                        <input type="text" id="bairro_${pessoaCounter}" name="pessoas[${pessoaCounter}][bairro]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Digite o bairro">
                    </div>
                    
                    <div>
                        <label class="label-custom">Munic√≠pio:</label>
                        <input type="text" id="municipio_${pessoaCounter}" name="pessoas[${pessoaCounter}][municipio]" 
                               class="input-custom mt-1 block w-full rounded-lg p-3" 
                               placeholder="Digite o munic√≠pio">
                    </div>
                    
                    <div>
                        <label class="label-custom">UF:</label>
                        <select id="uf_${pessoaCounter}" name="pessoas[${pessoaCounter}][uf]" 
                                class="input-custom mt-1 block w-full rounded-lg p-3">
                            <option value="">Selecione</option>
                            <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                            <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                            <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                            <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                            <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                            <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                            <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                            <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                            <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                        </select>
                    </div>
                </div>
            `;
            
            container.appendChild(pessoaDiv);
            
            // Preencher dados se fornecidos
            if (Object.keys(dados).length > 0) {
                Object.entries(dados).forEach(([key, value]) => {
                    const field = document.getElementById(`${key}_${pessoaCounter}`);
                    if (field) field.value = value;
                });
            }
            
            // Adicionar eventos
            adicionarEventosPessoa(pessoaCounter);
            atualizarContador();
        }

        function removerPessoa(id) {
            const pessoaDiv = document.getElementById(`pessoa-${id}`);
            if (pessoaDiv) {
                pessoaDiv.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    pessoaDiv.remove();
                    atualizarContador();
                }, 300);
            }
        }

        function adicionarEventosPessoa(pessoaId) {
            // CPF
            const cpfInput = document.getElementById(`cpf_${pessoaId}`);
            cpfInput.addEventListener('input', function() {
                this.value = formatarCPF(this.value);
            });
            cpfInput.addEventListener('blur', function() {
                if (this.value && !validarCPF(this.value)) {
                    showMessage('CPF inv√°lido!');
                    this.style.borderColor = 'var(--error)';
                } else {
                    this.style.borderColor = 'var(--primary)';
                }
            });

            // CEP
            const cepInput = document.getElementById(`cep_${pessoaId}`);
            cepInput.addEventListener('input', function() {
                this.value = formatarCEP(this.value);
            });
            cepInput.addEventListener('blur', function() {
                if (this.value.length === 9) {
                    buscarCEP(this.value, pessoaId);
                }
            });

            // Celular
            const celularInput = document.getElementById(`celular_${pessoaId}`);
            celularInput.addEventListener('input', function() {
                this.value = formatarCelular(this.value);
            });
        }

        // =================================================================
        // GERA√á√ÉO DA MENSAGEM
        // =================================================================
        function gerarMensagem() {
            let mensagem = '*üìã DADOS DO CADASTRO*\n\n';
            
            const pessoas = document.querySelectorAll('.pessoa-card');
            pessoas.forEach((pessoaCard, index) => {
                const pessoaNum = index + 1;
                const pessoaId = pessoaCard.id.split('-')[1];
                
                mensagem += `*Pessoa ${pessoaNum}:*\n`;
                mensagem += `Nome: ${document.getElementById(`nome_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `CPF: ${document.getElementById(`cpf_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `RG: ${document.getElementById(`rg_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `√ìrg√£o: ${document.getElementById(`orgao_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `Nascimento: ${document.getElementById(`nascimento_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `Nacionalidade: ${document.getElementById(`nacionalidade_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `Naturalidade: ${document.getElementById(`naturalidade_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `Estado Civil: ${document.getElementById(`estado_civil_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `Profiss√£o: ${document.getElementById(`profissao_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `Celular: ${document.getElementById(`celular_${pessoaId}`).value || 'N√£o informado'}\n`;
                mensagem += `E-mail: ${document.getElementById(`email_${pessoaId}`).value || 'N√£o informado'}\n`;
                
                // Endere√ßo
                const logradouro = document.getElementById(`logradouro_${pessoaId}`).value;
                const numero = document.getElementById(`numero_${pessoaId}`).value;
                const complemento = document.getElementById(`complemento_${pessoaId}`).value;
                const bairro = document.getElementById(`bairro_${pessoaId}`).value;
                const municipio = document.getElementById(`municipio_${pessoaId}`).value;
                const uf = document.getElementById(`uf_${pessoaId}`).value;
                const cep = document.getElementById(`cep_${pessoaId}`).value;
                
                if (logradouro || numero || bairro) {
                    mensagem += `Endere√ßo: ${logradouro}, ${numero}${complemento ? ', ' + complemento : ''}\n`;
                    mensagem += `${bairro} - ${municipio}/${uf}\n`;
                    mensagem += `CEP: ${cep || 'N√£o informado'}\n`;
                }
                
                mensagem += '\n';
            });
            
            mensagem += `*üìÖ Data:* ${new Date().toLocaleDateString('pt-BR')}\n`;
            mensagem += `*üïí Hor√°rio:* ${new Date().toLocaleTimeString('pt-BR')}`;
            
            return mensagem;
        }

        // =================================================================
        // EVENTOS
        // =================================================================
        document.addEventListener('DOMContentLoaded', function() {
            // Adicionar primeira pessoa
            adicionarPessoa();
            
            // Bot√£o adicionar
            document.getElementById('addPessoa').addEventListener('click', () => {
                adicionarPessoa();
                showMessage('Pessoa adicionada com sucesso!', 'success');
            });
            
            // Bot√£o remover
            document.getElementById('removePessoa').addEventListener('click', () => {
                const pessoas = document.querySelectorAll('.pessoa-card');
                if (pessoas.length > 1) {
                    const lastPessoa = pessoas[pessoas.length - 1];
                    const pessoaId = lastPessoa.id.split('-')[1];
                    removerPessoa(pessoaId);
                    showMessage('Pessoa removida!', 'success');
                } else {
                    showMessage('Deve haver pelo menos 1 pessoa!');
                }
            });
            
            // Modo teste
            document.getElementById('modoTeste').addEventListener('click', preencherTeste);
            
            // Enviar WhatsApp
            document.getElementById('enviarWhatsApp').addEventListener('click', function() {
                const form = document.getElementById('formularioCadastro');
                
                if (!form.checkValidity()) {
                    form.reportValidity();
                    showMessage('Preencha todos os campos obrigat√≥rios (*)');
                    return;
                }
                
                // Validar CPFs
                let cpfValido = true;
                document.querySelectorAll('.cpf-input').forEach(input => {
                    if (input.value && !validarCPF(input.value)) {
                        cpfValido = false;
                    }
                });
                
                if (!cpfValido) {
                    showMessage('Um ou mais CPFs s√£o inv√°lidos!');
                    return;
                }
                
                const mensagem = gerarMensagem();
                const url = `https://wa.me/${numeroWhatsApp}?text=${encodeURIComponent(mensagem)}`;
                window.open(url, '_blank');
                
                showMessage('Mensagem enviada para o WhatsApp!', 'success');
            });
        });
        
        // =================================================================
        // MODO TESTE
        // =================================================================
        function preencherTeste() {
            document.getElementById('pessoasContainer').innerHTML = '';
            pessoaCounter = 0;
            
            // Pessoa 1
            adicionarPessoa({
                nome: 'Jo√£o Silva Santos',
                cpf: '123.456.789-00',
                rg: '1234567890',
                orgao: 'SSP/RS',
                nascimento: '1980-05-15',
                nacionalidade: 'Brasileira',
                naturalidade: 'Porto Alegre/RS',
                estado_civil: 'Solteiro(a)',
                profissao: 'Empres√°rio',
                celular: '(51) 99999-8888',
                email: 'joao.silva@email.com',
                cep: '90000-000',
                logradouro: 'Rua das Palmeiras',
                numero: '456',
                bairro: 'Centro',
                municipio: 'Porto Alegre',
                uf: 'RS'
            });
            
            // Pessoa 2
            adicionarPessoa({
                nome: 'Maria Oliveira Costa',
                cpf: '987.654.321-00',
                rg: '0987654321',
                orgao: 'SSP/RS',
                nascimento: '1985-08-20',
                nacionalidade: 'Brasileira',
                naturalidade: 'Santa Maria/RS',
                estado_civil: 'Casado(a)',
                profissao: 'Advogada',
                celular: '(51) 98888-7777',
                email: 'maria.costa@email.com',
                cep: '91000-000',
                logradouro: 'Avenida Brasil',
                numero: '123',
                bairro: 'Centro',
                municipio: 'Porto Alegre',
                uf: 'RS'
            });
            
            showMessage('Dados de teste preenchidos!', 'success');
        }
    </script>
</body>
</html>
